[
  {
    "objectID": "Statistik.html",
    "href": "Statistik.html",
    "title": "Komplement till Sides i Statistik",
    "section": "",
    "text": "Det står på sidan 23 av sliden till föreläsning 3 att ju starkare effekten är, desto större blir testets styrka. Om vi testar \\[\\begin{eqnarray*}\n\\text{H0: det finns ingen skillnad}\n\\end{eqnarray*}\\] innebär det att strykan är större om skillnaden är större. Vi kan genomföra en simuleringsstudie för att bevisa detta. Till exempel, jag vill testar \\[\\begin{eqnarray*}\n\\text{H0: det finns ingen skillnad mellan väntevärdena av två oberoende grupper}\n\\end{eqnarray*}\\] mot \\[\\begin{eqnarray*}\n\\text{H1: det finns en skillnad mellan väntevärdena.}\n\\end{eqnarray*}\\] Jag simulerar \\(n=100\\) observationer från slumpvariabeln \\(X \\sim N(0, 1)\\) och \\(n=100\\) observationer från slumpvariabeln \\(Y \\sim N(\\mu, 1)\\). Skillnaden i väntevärde mellan grupperna är \\[\\begin{eqnarray*}\n\\text{E}(X) - \\text{E}(Y) & = & -\\mu.\n\\end{eqnarray*}\\] T-testet kan används för att testa skillnaden. Jag jämför p-värdet med signifikansnivå 0.05. Jag kan upprepa simuleringen \\(10 000\\) gånger. Resultatet sparas i vektorn Signifikant. Om \\(\\text{Signifikant[i]}=1\\) innebär att den i:e simuleringen ledar till ett signifikant resultat (p-värdet < 0.05). Annars \\(\\text{Signifikant[i]}=0\\).\n\n\n\n\nMu <- 0.1 # Väntevärdet av Y\nSignifikant <- numeric(10000)\nfor(i in 1 : 10000){\n    ## Simulera X och Y\n    X <- rnorm(n = 100, mean = 0, sd = 1)\n    Y <- rnorm(n = 100, mean = Mu, sd = 1)\n    ## Genomföra t test \n    test <- t.test(X, Y)\n    ## Obtain p-value\n    Pvalue <- test$p.value\n    ## Jämföra p-värdet med signifikansnivå 0.05\n    Signifikant[i] <- (Pvalue <= 0.05)\n}\n\nStyrkan hos ett statistiskt hypotestest är sannolikheten att förkasta H0 om H1 är sann. I exempelet ovan är H1 sann eftersom \\(\\mu = 0.1\\), alltså det finns en skillnad mellan grupperna. Vi kan därför uppskatta styrkan genom mean(Signifikant), dvs andelen signifikanta resultat i vår simulering:\n\nmean(Signifikant)\n\n[1] 0.1072\n\n\nNu ökar jag \\(\\mu=0.1\\) till \\(\\mu=0.25\\) och genomför simuleringen igen.\n\n\n\n\nMu <- 0.25 # Väntevärdet av Y\nSignifikant <- numeric(10000)\nfor(i in 1 : 10000){\n    ## Simulera X och Y\n    X <- rnorm(n = 100, mean = 0, sd = 1)\n    Y <- rnorm(n = 100, mean = Mu, sd = 1)\n    ## Genomföra t test \n    test <- t.test(X, Y)\n    ## Obtain p-value\n    Pvalue <- test$p.value\n    ## Jämföra p-värdet med signifikansnivå 0.05\n    Signifikant[i] <- (Pvalue <= 0.05)\n}\n\nSkattningen av strykan blir\n\nmean(Signifikant)\n\n[1] 0.4247\n\n\nvilket är större än strykan när \\(\\mu = 0.1\\).\nOm jag ökar \\(\\mu=\\) till \\(\\mu=1\\) skulle jag får en ännu större styrka. Vi kan kolla om det stämmer.\n\n\n\n\nMu <- 1 # Väntevärdet av Y\nSignifikant <- numeric(10000)\nfor(i in 1 : 10000){\n    ## Simulera X och Y\n    X <- rnorm(n = 100, mean = 0, sd = 1)\n    Y <- rnorm(n = 100, mean = Mu, sd = 1)\n    ## Genomföra t test \n    test <- t.test(X, Y)\n    ## Obtain p-value\n    Pvalue <- test$p.value\n    ## Jämföra p-värdet med signifikansnivå 0.05\n    Signifikant[i] <- (Pvalue <= 0.05)\n}\n\nSkattningen av strykan blir\n\nmean(Signifikant)\n\n[1] 1\n\n\nVi kan nästan alltid upptäcka en skillnad mellan grupperna!"
  },
  {
    "objectID": "Statistik.html#h0-mu-3800-textgram-mot-h1-mu-neq-3800-textgram",
    "href": "Statistik.html#h0-mu-3800-textgram-mot-h1-mu-neq-3800-textgram",
    "title": "Komplement till Sides i Statistik",
    "section": "2.1 H0: \\(\\mu = 3800 \\text{gram}\\) mot H1: \\(\\mu \\neq 3800 \\text{gram}\\)",
    "text": "2.1 H0: \\(\\mu = 3800 \\text{gram}\\) mot H1: \\(\\mu \\neq 3800 \\text{gram}\\)\nVi börjar med att testa H0: \\(\\mu = 3800 \\text{gram}\\) mot H1: \\(\\mu \\neq 3800 \\text{gram}\\). Den standardiserade differensen mellan medelvikt och 3800 gram är \\[\\begin{eqnarray}\nt & = & \\frac{\\bar{x} - 3800}{s / \\sqrt{n}},\n\\end{eqnarray}\\] där \\(\\bar{x}\\) är medelvikt som vi beräknar från data, och \\(s / \\sqrt{n}\\) är standardfel. Sådan standardiserad differens mäter skillnaden mellan data och vår H0.\n\nOm \\(t\\) är mycket större än 0 innebär att vår data tyder på att medelvikten är större än H0.\nOm \\(t\\) är mycket mindre än 0 innebär att vår data tyder på att medelvikten är mindre än H0.\n\nNär vi använder t.test() för att testa H0 mot H1 ovan får vi resultatet\n\nt.test(vikt, mu = 3800)\n\n\n    One Sample t-test\n\ndata:  vikt\nt = -2.662, df = 150, p-value = 0.008616\nalternative hypothesis: true mean is not equal to 3800\n95 percent confidence interval:\n 3626.926 3774.398\nsample estimates:\nmean of x \n 3700.662 \n\n\n\\(t = -2.662\\) är den standardiserade skillnaden som vi kan beräkna från vår data. Vi måste bestämma om detta t-värde avviker tillräckligt från H0. Om data är normalfördelade och H0 stämmer följer \\(t\\) en t-fördelning med frihetsgrader \\(n - 1\\). Det betyder att \\(100(1 - \\alpha)%\\) av alla studier skulle ge \\(-t_{\\alpha/2}^{(n-1)} < t < t_{\\alpha/2}^{(n-1)}\\) om vi kan upprepa samma studie många gånger. I vårt exempel är frihetsgraderna 150 (eftersom vi har \\(151\\) observationer) och \\(t_{\\alpha/2}^{(n-1)} = 1.975799\\):\n\nqt(p = 1 - 0.05 / 2, df = 151 - 1)\n\n[1] 1.975905\n\n\nDet innebär att ett t-värde som ligger mellan \\(-1.975905\\) och \\(1.975905\\) anses vara helt “normalt” om H0 är sann. Om t-värdet ligger utanför \\((-1.975905, 1.975905)\\) anses vår data “konstiga” under H0. Det vill säga, om absolutbeloppet av \\(t\\) är stort tyder det på att H0 inte stämmer. P-värdet defineras som sannolikheten att få ett resultat som är “minst lika extremt” som det observerade, om H0 är sann. I vårt exempel betyder “minst lika extremt” att absolutbeloppet av den standardiserade differensen \\(t = \\frac{\\bar{x} - 4000}{s / \\sqrt{n}}\\) är större eller lika med absolutebeloppet av \\(t = -2.662\\), t-värdet som vi beräknar från data. Därför beräknar vi p-värdet som \\[\\begin{eqnarray}\nP\\left( \\left| \\frac{\\bar{x} - 4000}{s / \\sqrt{n}} \\right| \\geq \\left| -2.662 \\right| \\right) & = & P\\left( \\frac{\\bar{x} - 4000}{s / \\sqrt{n}} \\leq -2.662 \\right) + P\\left( \\frac{\\bar{x} - 4000}{s / \\sqrt{n}} \\geq 2.662 \\right)\n\\end{eqnarray}\\]\n\npt(q = -2.662, df = 151 - 1) + \n    (1 - pt(q = 2.662, df = 151 - 1))\n\n[1] 0.008614753\n\n\nP-värdet avviker lite eftersom R använder fler decimaler för \\(t\\).\nJag kan rita täthetsfunktionen av t-fördelningen. P-värdet är egentligen den röda ytan under kurvan. Den blåa ytan motsvarar en “normal” standardiserade differens.\n\n\n\n\n\nFrån resultatet av t.test() står det att “95 percent confidence interval: 3626.926, 3774.398”. Det betyder att \\(95\\%\\) konfidensintervallet för medelviken \\(\\mu\\) är \\(3626.926 < \\mu < 3774.398\\). Nullhypotesen är H0: \\(\\mu = 3800\\). Om sådan \\(3800\\) ingår i konfidensintevallet tyder på att H0 stämmer vid 5% signifikansnivå. Annars förkastar vi H0.\nVi kan även ser resultatet “sample estimates: mean of x 3700.662” från t.test(). Det betyder medelvärdet av våra data är 3700.662:\n\nmean(vikt)\n\n[1] 3700.662\n\n\nDu får inte jämföra medelvärdet med konfidensintervallet för att bestämma om H0 stämmer. Värför det? Stickprovs medelvärde ligger alltid i konfidensintervallet! För att testa H0 använder vi det antagna värdet i H0, dvs 3800 i vårt exempel."
  }
]